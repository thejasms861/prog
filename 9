import numpy as np 
import pandas as pd 
from sklearn.model_selection import train_test_split 
from sklearn.linear_model import LinearRegression 
from sklearn.metrics import mean_squared_error, r2_score 
from sklearn.preprocessing import OneHotEncoder 
from sklearn.compose import ColumnTransformer 
# Load the dataset 
data = pd.read_csv('50_Startups.csv') 
df = pd.DataFrame(data) 
# Display the dataset 
print("Dataset:") 
print(df.head()) 
# Features (X) and target (y) 
X = df.drop(columns=['Profit']) 
y = df['Profit'] 
# Handle categorical variables (OneHotEncoding for 'State') 
column_transformer = ColumnTransformer( 
transformers=[('encoder', OneHotEncoder(), ['State'])], remainder='passthrough') 
X = column_transformer.fit_transform(X) 
# Split the dataset into training and testing sets 
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42) 
# Initialize the Linear Regression model 
model = LinearRegression() 
# Train the model on the training data 
model.fit(X_train, y_train) 
# Make predictions on the test data 
y_pred = model.predict(X_test) 
# Evaluate the model 
mse = mean_squared_error(y_test, y_pred) 
r2 = r2_score(y_test, y_pred) 
print(f"Mean Squared Error: {mse}") 
print(f"R-squared Score: {r2}") 
# Display the coefficients and intercept 
print("Coefficients:", model.coef_) 
print("Intercept:", model.intercept_)
